# 🏢 Автоматический Агрегатор Недвижимости - София, Болгария

Полностью автоматическая система для сбора и мониторинга объявлений о недвижимости от всех ведущих агентств Софии.

## ✨ Возможности

- 🔄 **Автоматический сбор** - мониторинг 5+ агентств недвижимости
- 📊 **Умная фильтрация** - цена, площадь, расположение, тип недвижимости
- 📧 **Уведомления** - email оповещения о новых объявлениях
- 💾 **База данных** - хранение и анализ всех объявлений
- 🌐 **Веб-интерфейс** - красивый UI для просмотра и анализа
- 📈 **Аналитика** - графики, тренды, статистика рынка
- 🤖 **Расширяемость** - легко добавить новые агентства

## 🚀 Быстрый старт

```bash
# 1. Установка
npm install

# 2. Инициализация БД
npm run db:init

# 3. Настройка агрегатора
npm run auto:setup

# 4. Запуск мониторинга
npm run auto:start
```

**Готово!** Система автоматически собирает новые объявления каждые 15 минут.

## 📋 Настроенные агентства

1. ✅ **UES.bg** - Unique Estates
2. ✅ **Luximmo.bg** - Luximmo Finest Estates
3. ✅ **BulgarianProperties.com** - Bulgarian Properties
4. ✅ **Yavlena.com** - Yavlena (Явлена)
5. ✅ **Address.bg** - АДРЕС Недвижими имоти

+ возможность добавить любые другие агентства автоматически!

## 🎯 Основные команды

### Автоматический мониторинг

```bash
# Запустить непрерывный мониторинг
npm run auto:start

# Однократная проверка (тест)
npm run auto:once

# Проверить статус
npm run auto:status

# Настроить фильтры
npm run auto:config -- --min-price 500 --max-price 2000
```

### Управление агентствами

```bash
# Список всех агентств
npm run aggregator:list

# Добавить новое агентство автоматически
npm run aggregator:analyze https://new-agency.bg --name "Agency" --save

# Включить/выключить агентство
npm run aggregator toggle agency_id
```

### Статистика и просмотр

```bash
# Статистика собранных объявлений
npm run aggregator:stats

# Веб-интерфейс для просмотра
npm run web
# Откройте http://localhost:3000
```

## ⚙️ Настройка фильтров

```bash
# Диапазон цен (EUR)
npm run auto:config -- --min-price 800 --max-price 1500

# Email для уведомлений
npm run auto:config -- --email your@email.com

# Частота проверки (каждые 10 минут)
npm run auto:config -- --interval "*/10 * * * *"

# Включить мониторинг
npm run auto:config -- --enable
```

## 📊 Веб-интерфейс

Запустите веб-сервер для красивого интерфейса:

```bash
npm run web
```

Возможности веб-интерфейса:
- 🔍 Расширенный поиск с фильтрами
- 📈 Графики и аналитика рынка
- 💰 Анализ цен по районам
- 📸 Галерея фото объявлений
- ⭐ Избранные объявления
- 📊 Статистика по типам недвижимости

## 🎨 Примеры использования

### Поиск бюджетной квартиры

```bash
npm run auto:config -- --min-price 400 --max-price 800 --enable
npm run auto:config -- --interval "*/5 * * * *"
npm run auto:start
```

### Мониторинг премиум сегмента

```bash
npm run auto:config -- --min-price 2000 --max-price 5000
npm run auto:start
```

### Добавить новое агентство

```bash
npm run aggregator:analyze https://new-agency.bg \
  --name "New Agency" \
  --save
```

## 📚 Документация

- **[AGGREGATOR_GUIDE.md](./AGGREGATOR_GUIDE.md)** - Полное руководство по агрегатору
- **[MONITORING_SETUP.md](./MONITORING_SETUP.md)** - Настройка уведомлений
- **[README.md](./README.md)** - English documentation

## 🔧 Архитектура

```
┌─────────────────────────────────────────────┐
│         Автоматический Мониторинг           │
│    (каждые 15 минут по умолчанию)           │
└──────────────────┬──────────────────────────┘
                   │
        ┌──────────┴──────────┐
        │                     │
┌───────▼──────┐    ┌────────▼────────┐
│  Агентства   │    │   База данных   │
│              │    │   PostgreSQL    │
│ • UES.bg     │───▶│                 │
│ • Luximmo    │    │ • Объявления    │
│ • Yavlena    │    │ • История       │
│ • Address    │    │ • Статистика    │
│ • ...        │    │                 │
└──────────────┘    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  Веб-интерфейс  │
                    │  + API          │
                    │  Port: 3000     │
                    └─────────────────┘
```

## 🛠️ Технологии

- **TypeScript** - основной язык
- **Playwright** - автоматизация браузера
- **PostgreSQL** - база данных
- **Express** - веб-сервер
- **Node-cron** - планировщик задач
- **Cheerio** - парсинг HTML

## 🤝 Поддерживаемые агентства

Система легко расширяется. Уже настроены:

1. UES.bg - Unique Estates
2. Luximmo.bg - Luximmo Finest Estates
3. BulgarianProperties.com
4. Yavlena.com - Yavlena
5. Address.bg - АДРЕС

Можно легко добавить:
- SUPRIMMO
- ERA
- Imoteka
- IRIDA
- BuildingBox
- И любые другие!

## 📈 Что дальше?

1. **Настройте фильтры** под ваши требования
2. **Запустите мониторинг** и получайте уведомления
3. **Используйте веб-интерфейс** для анализа рынка
4. **Добавьте больше агентств** при необходимости

## 🆘 Помощь

Если что-то не работает:

```bash
# Проверить статус БД
npm run db:status

# Посмотреть статистику
npm run aggregator:stats

# Проверить конфигурацию
npm run auto:config -- --show

# Запустить тест
npm run auto:once
```

Подробная документация: [AGGREGATOR_GUIDE.md](./AGGREGATOR_GUIDE.md)

---

**Удачи в поиске идеальной недвижимости в Софии! 🏠✨**
